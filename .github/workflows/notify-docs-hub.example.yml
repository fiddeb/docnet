# Example workflow to add to each source repository (observabilitystack, etc.)
# This notifies the docs-hub when documentation changes are pushed
#
# Setup instructions:
# 1. Copy this file to each source repo: .github/workflows/notify-docs-hub.yml
# 2. Create a fine-grained PAT with workflow trigger permissions for docs-hub
# 3. Add the PAT as DOCS_HUB_TOKEN secret in each source repository
# 4. Update the repository field below to match your docs-hub repo

name: Notify docs hub

on:
  push:
    branches: [ main ]
    paths:
      - "docs/**"
      - "mkdocs.yml"
      - "mkdocs.yaml"
      - "README.md"

jobs:
  dispatch:
    runs-on: ubuntu-latest
    steps:
      - name: Send repository_dispatch to docs-hub
        uses: peter-evans/repository-dispatch@v4
        with:
          token: ${{ secrets.DOCS_HUB_TOKEN }}
          repository: fiddeb/docnet  # Update with your docs-hub repository
          event-type: docs-updated
          client-payload: |
            {
              "source_repo": "${{ github.repository }}",
              "source_sha": "${{ github.sha }}"
            }
