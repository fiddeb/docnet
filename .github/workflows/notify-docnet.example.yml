# Example workflow to add to each source repository (observabilitystack, etc.)
# This notifies docnet when documentation changes are pushed
#
# Setup instructions:
# 1. Copy this file to each source repo: .github/workflows/notify-docnet.yml
# 2. Create a fine-grained PAT with workflow trigger permissions for docnet
# 3. Add the PAT as DOCNET_TOKEN secret in each source repository
# 4. Update the repository field below to match your docnet repo

name: Notify docnet

on:
  push:
    branches: [ main ]
    paths:
      - "docs/**"
      - "mkdocs.yml"
      - "mkdocs.yaml"
      - "README.md"

jobs:
  dispatch:
    runs-on: ubuntu-latest
    steps:
      - name: Send repository_dispatch to docnet
        uses: peter-evans/repository-dispatch@v4
        with:
          token: ${{ secrets.DOCNET_TOKEN }}
          repository: fiddeb/docnet  # Update with your docnet repository
          event-type: docs-updated
          client-payload: |
            {
              "source_repo": "${{ github.repository }}",
              "source_sha": "${{ github.sha }}"
            }
